; States file for Darkseid -- Specials
;
;---------------------------------------------------------------------------
; Vars:
;   0: for Super Jump (0=vertical, 1=forward, -1=backward)
; Helpers:
;   0: superjump opponent position indicator
; Explods:
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; Special Attacks
; 
; Omega Blast
;---------------------------------------------------------------------------

[StateDef 1000]
anim = 0
ctrl = 0
type = S
movetype = A
physics = S
velset = 0,0
poweradd = 100

[State 1000, voice]
type = PlaySnd
trigger1 = Time = 5
value = 10,10
channel = 0

[State 1000, Helper]
type = Helper
trigger1 = Time = 1
helpertype = normal
name = "Omega Blast"
ID = 1010
stateno = 1010
pos = 0,-140
postype = p1
facing = 1
size.xscale = 0.5
size.yscale = 0.5

[State 1000, back to stance]
type = ChangeState
trigger1 = Time = 10
value = 0
ctrl = 1


;-----------------
;(adapted from FlowaGirl's Homing Projectiles tutorial)
; Omega Blast - beam custom state
[StateDef 1010]
type    = A
movetype= A
physics = N
anim = 1010

[State 1010, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1010, Turn]
type = Turn
trigger1 = (P2Dist X < 10)

[State 1010, VelSet]
type = VelSet
trigger1 = (!Time)
x = 3

[State 1010, VarSet]
type = VarSet
trigger1 = IsHelper
fv = 2
value = (EnemyNear, Const(size.mid.pos.y))

[State 1010, VelAdd]
type = VelAdd
trigger1 = (P2Dist X < 0) && (Vel X > -1)
x = -0.1

[State 1010, VelAdd]
type = VelAdd
trigger1 = (P2Dist X > 0) && (Vel X < 1)
x = 0.1

[State 1010, VelAdd]
type = VelAdd
trigger1 = (FVar(2) > Pos Y) && (Vel Y < 1)
y = 0.1

[State 1010, VelAdd]
type = VelAdd
trigger1 = (FVar(2) < Pos Y) && (Vel Y > -1)
y = -0.1

[State 1010, VelSet]
type = VelSet
trigger1 = (FVar(2) = Pos Y)
y = 0

[State 1010, HitDef]
type = HitDef
trigger1 = 1
attr = A,HP
hitflag = MAFD
guardflag = MA
animtype = hard
priority = 7,Hit
damage = 100,30
;pausetime = 1,8
;sparkno = 0
;guard.sparkno = 0
hitsound = S2,2
;sparkxy = 0,0
priority = 2,Hit
sprpriority = 2
ground.type = Low
ground.slidetime = 2
ground.hittime = 5
ground.velocity = -3, -4
air.velocity = -4, -5
fall = 1
fall.recover = 0
down.bounce = 1
kill = 1
palfx.time = 20
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
;p2stateno = 7697

[State 1010, no shadow]
type = AssertSpecial
trigger1 = Pos Y >= -1
flag = noshadow

[State 1010, afterimages]
type = AfterImage
trigger1 = Time = 0
time = 300
length = 60
timegap = 1
framegap = 1
palcolor = 256
paladd = 0,-200,-200
palmul = 25.0,1.0,1.0
;palcontrast = 255
trans = add

[State 1010, DestroySelf]
type = DestroySelf
trigger1 = MoveContact

; -------------------------------------
; Omega Armor (hit override for everything)
[StateDef 2000]
anim = 0
ctrl = 0
type = S
movetype = A
physics = S
velset = 0,0

;Generated by Fighter Factory PalFX Editor
[State 2000, PalFXWiz]
type = PalFX
trigger1 = Time = 0
time = 20
add = 0,-200,-200
mul = 256,256,256
sinadd = 40,80,40,10
invertall = 1
color = 0

[State 2000, ChangeState]
type = ChangeState
trigger1 = Time = 20
value = 0
ctrl = 1

